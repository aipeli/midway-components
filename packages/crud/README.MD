<h1 align="center">ğŸ‰ğŸš€midway-crudğŸ‰ğŸ‘‹</h1>
<p align="center">
<img src="https://img.shields.io/badge/node-%3E%3D16.0.0-blue.svg" />  
<img src="https://img.shields.io/badge/midway-%3E%3D3.0.0-success.svg" />  
<img src="https://img.shields.io/badge/é€‚ç”¨-æ ‡å‡†é¡¹ç›®-success.svg?style=social&logo=github" /> 
</p>

## ğŸ  [é¡¹ç›®ä¸»é¡µ](https://github.com/aipeli/midway-components)

> - å¯ä»¥æ ¹æ®ç›®å½•ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼ˆåŒ…æ‹¬ï¼šadd delete upate info list pageï¼‰

> - å¯ä»¥æ ¹æ®ä¸åŒ controller è®¾ç½®ä¸­é—´ä»¶

> - å¯ä»¥å¤šæ¡ä»¶å¤æ‚æŸ¥è¯¢

## ğŸ“¦ ç¯å¢ƒè¦æ±‚

- midway &gt;=3.x

## ğŸ› ï¸ å®‰è£…

```sh
pnpm install @aipeli/midway-crud
```

## âœï¸ ç”¨æ³•

ä¸€ã€åˆ›å»º MidwayJS é¡¹ç›®

```bash
npm init midway
```

- é€‰æ‹© `koa-v3`

äºŒã€ä¿®æ”¹ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
â””â”€src
    â”‚  configuration.ts
    â”‚  interface.ts
    â”œâ”€config
    â”‚      config.default.ts
    â”‚      config.unittest.ts
    â”œâ”€filter
    â”‚      default.filter.ts
    â”‚      notfound.filter.ts
    â”œâ”€middleware
    â”‚      global.ts
    â””â”€modules
        â””â”€shop
            â”œâ”€controller
            â”‚  â”œâ”€admin
            â”‚  â”‚      home.ts
            â”‚  â””â”€api
            â”‚          login.ts
            â”œâ”€entity
            â”‚      user.ts
            â”œâ”€middleware
            â”‚      log.ts
            â””â”€service
                    user.ts
```

ä¸‰ã€package.json ä¾èµ–åŒ…

```json
{
  "dependencies": {
    "@aipeli/midway-crud": "^1.0.0",
    "@midwayjs/bootstrap": "^3.0.0",
    "@midwayjs/core": "^3.0.0",
    "@midwayjs/decorator": "^3.0.0",
    "@midwayjs/info": "^3.0.3",
    "@midwayjs/koa": "^3.0.0",
    "@midwayjs/logger": "^2.14.2",
    "@midwayjs/orm": "^3.0.2",
    "@midwayjs/validate": "^3.0.3",
    "mysql2": "^2.3.3"
  },
  "devDependencies": {
    "@midwayjs/cli": "^1.2.97",
    "@midwayjs/mock": "^3.0.0",
    "@types/jest": "^27.4.0",
    "@types/koa": "^2.13.4",
    "@types/node": "17",
    "cross-env": "^7.0.3",
    "jest": "^27.5.0",
    "mwts": "^1.3.0",
    "ts-jest": "^27.1.3",
    "typescript": "^4.5.5"
  }
}
```

> `@midwayjs/bootstrap`ã€`@midwayjs/core`ã€`@midwayjs/decorator`ã€`@midwayjs/koa`ã€`@midwayjs/orm`ã€`@midwayjs/validate`

ä»¥ä¸ŠåŒ…å¿…é¡»ä¿æŒ 3.x ä»¥ä¸Š

å››ã€é…ç½® CRUD åŒ…

1ã€configuration.ts

```
import * as crud from '@aipeli/midway-crud';
```

```
@Configuration({
  imports: [
    koa,
    orm,
    validate,
    crud,
  ],
  importConfigs: [join(__dirname, './config')],
})
```

2ã€åœ¨`src/config/config.default.ts`ä¸­é…ç½® orm

```
  orm: {
    /**
     * å•æ•°æ®åº“å®ä¾‹
     */
    type: 'mysql',
    host: '127.0.0.1',
    port: 3306,
    username: 'root',
    password: 'root',
    database: 'midway_crud',
    synchronize: true, // æ˜¯å¦åŒæ­¥è¡¨
    logging: false,
  },
```

äº”ã€ä½¿ç”¨ CRUD åŒ…

1ã€entity

```typescript
import { EntityModel } from '@midwayjs/orm';
import { BaseEntity } from '@aipeli/midway-crud';
import { Column } from 'typeorm';

/**
 * æè¿°
 */
@EntityModel('shop_user')
export class ShopUserEntity extends BaseEntity {
  @Column({ comment: 'å§“å' })
  name: string;
}
```

2ã€service

```typescript
import { Repository } from 'typeorm';
import { Provide } from '@midwayjs/decorator';
import { InjectEntityModel } from '@midwayjs/orm';
import { BaseService } from '@aipeli/midway-crud';
import { ShopUserEntity } from '../entity/user';

@Provide()
export class ShopUserService extends BaseService {
  @InjectEntityModel(ShopUserEntity)
  userModel: Repository<ShopUserEntity>;

  async getUser(id: number) {
    const user = await this.userModel.findOne(id);
    return user;
  }
}
```

3ã€controller

```typescript
import { Crud, BaseController } from '@aipeli/midway-crud';
import { Get, Inject, Query } from '@midwayjs/decorator';
import { ShopUserEntity } from '../../entity/user';
import { ShopUserService } from '../../service/user';

/**
 * url: http://127.0.0.1:7001/admin/shop/user/add (delete, update, info, list, page)
 * get: info
 * post: add, delete, update, list, page
 */
@Crud({
  api: ['add', 'delete', 'update', 'info', 'list', 'page'],
  entity: ShopUserEntity,
  service: ShopUserService,
})
export class ShopAdminUserController extends BaseController {
  @Inject()
  userService: ShopUserService;

  // è‡ªå®šä¹‰
  // http://127.0.0.1:7001/admin/shop/user/get_user?id=1
  @Get('/get_user')
  async get_user(@Query('id') id) {
    const user = await this.userService.getUser(id);
    return this.success(user);
  }
}
```

## ğŸ§‘ [è´¡çŒ®ã€æœŸå¾…ä½ çš„åŠ å…¥ï¼Œå…±åŒå­¦ä¹ ã€‘](https://github.com/aipeli/midway-components/graphs/contributors)

<figure>
<a href="https://github.com/aipeli"><img src="https://avatars.githubusercontent.com/u/43819745?s=80&v=4"/></a>
</figure>

## ğŸ¤ ISSUES

æ¬¢è¿æŠ•ç¨¿ã€æé—®å’ŒåŠŸèƒ½è¯·æ±‚ï¼ [issues åœ°å€](https://github.com/aipeli/midway-components/issues).

## â­ï¸ æ”¯æŒ

å¦‚æœé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª start â­ï¸ å§!

- ğŸ’¼ GitHub: [@midway-components](https://github.com/aipeli/midway-components)

## ğŸ“ License

Copyright Â© 2022 [aipeli](https://github.com/aipeli). This project is [MIT](LICENSE) licensed.

---

_This README was generated with â¤ï¸ by [fast-readme](https://www.npmjs.com/package/@fastjsui/fast-readme)_
